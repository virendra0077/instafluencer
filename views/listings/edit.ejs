<% layout('layout/boilerplate') %>

<body class="profile-bg">

  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-7 col-md-9">

        <div class="card profile-card profile-form-card border-0 shadow-lg">
          <div class="card-body p-4 p-md-5">

            <div class="text-center mb-5">
               <div class="mb-3">
                <i class="fa-solid fa-pen-to-square fa-3x"></i>
              </div>
              <h2 class="fw-bold mb-1">Edit Profile</h2>
              <p class="text-muted">Keep your stats and info up to date to attract more brands.</p>
            </div>

            <form action="/listings/<%= listing._id %>?_method=PUT" method="POST" class="needs-validation" novalidate>

              <div class="mb-4">
                <label class="form-label fw-bold small text-uppercase">Full Name / Brand Name</label>
                <div class="input-group">
                  <span class="input-group-text bg-transparent border-end-0">
                    <i class="fa-regular fa-user"></i>
                  </span>
                  <input type="text" class="form-control border-start-0 ps-0" name="listing[name]" value="<%= listing.name %>" required />
                  <div class="invalid-feedback">Name is required.</div>
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-bold small text-uppercase">Profile Image URL</label>
                <div class="d-flex align-items-center mb-2">
                    <img src="<%= listing.image %>" class="rounded-circle me-3 border" style="width: 50px; height: 50px; object-fit: cover;" alt="current">
                    <div class="input-group">
                        <span class="input-group-text bg-transparent border-end-0">
                          <i class="fa-regular fa-image"></i>
                        </span>
                        <input type="url" class="form-control border-start-0 ps-0" name="listing[image]" value="<%= listing.image %>" placeholder="https://example.com/image.jpg" />
                    </div>
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-bold small text-uppercase">Location</label>
                <div class="input-group">
                  <span class="input-group-text bg-transparent border-end-0">
                    <i class="fa-solid fa-location-dot"></i>
                  </span>
                  <input type="text" class="form-control border-start-0 ps-0" name="listing[address]" value="<%= listing.address %>" required />
                  <div class="invalid-feedback">Location is required.</div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-4">
                  <label class="form-label fw-bold small text-uppercase">Followers</label>
                  <div class="input-group">
                    <span class="input-group-text bg-transparent border-end-0">
                      <i class="fa-solid fa-users"></i>
                    </span>
                    <input type="number" class="form-control border-start-0 ps-0" name="listing[followers]" value="<%= listing.followers %>" min="0" />
                  </div>
                </div>
                <div class="col-md-6 mb-4">
                  <label class="form-label fw-bold small text-uppercase">Reach</label>
                  <div class="input-group">
                    <span class="input-group-text bg-transparent border-end-0">
                      <i class="fa-solid fa-chart-line"></i>
                    </span>
                    <input type="number" class="form-control border-start-0 ps-0" name="listing[reach]" value="<%= listing.reach %>" min="0" />
                  </div>
                </div>
              </div>

              <div class="mb-4">
                <label class="form-label fw-bold small text-uppercase">Tell us a bit about yourself.</label>
                <textarea class="form-control" name="listing[description]" rows="4" required><%= listing.description %></textarea>
                <div class="invalid-feedback">Description cannot be empty.</div>
              </div>

              <div class="mb-5">
                <label class="form-label fw-bold small text-uppercase">Content Category</label>
                <select class="form-select" name="listing[type]" required>
                  <option value="">Select category...</option>
                  <option value="family content" <%= listing.type === "family content" ? "selected" : "" %>>Family Content</option>
                  <option value="mature content" <%= listing.type === "mature content" ? "selected" : "" %>>Mature Content</option>
                  <option value="lifestyle" <%= listing.type === "lifestyle" ? "selected" : "" %>>Lifestyle</option>
                  <option value="fashion" <%= listing.type === "fashion" ? "selected" : "" %>>Fashion & Beauty</option>
                </select>
                <div class="invalid-feedback">Please select a content type.</div>
              </div>

              <div class="d-flex gap-3">
                <a href="/listings/<%= listing._id %>" class="btn btn-outline-secondary btn-lg flex-fill py-3">
                  Cancel
                </a>
                <button type="submit" class="btn btn-gradient btn-lg flex-fill py-3 shadow">
                  Save Changes
                </button>
              </div>

            </form>
          </div>
        </div>
        
        <div class="text-center mt-4">
            <form action="/listings/<%= listing._id %>?_method=DELETE" method="POST">
                <button class="btn btn-link text-danger text-decoration-none small">
                    <i class="fa-regular fa-trash-can me-1"></i> Delete Profile Permanently
                </button>
            </form>
        </div>

      </div>
    </div>
  </div>

</body>